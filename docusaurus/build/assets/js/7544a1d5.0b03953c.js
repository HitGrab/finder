"use strict";(self.webpackChunkfinder_docs=self.webpackChunkfinder_docs||[]).push([[9672],{1112:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>j,contentTitle:()=>g,default:()=>I,frontMatter:()=>p,metadata:()=>s,toc:()=>f});const s=JSON.parse('{"id":"getting-started/context/injecting-state","title":"Dependent Finder.Content components","description":"User story:","source":"@site/docs/getting-started/context/injecting-state.md","sourceDirName":"getting-started/context","slug":"/getting-started/context/injecting-state","permalink":"/finder/getting-started/context/injecting-state","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Dependent Rules","permalink":"/finder/getting-started/context/context-rules"},"next":{"title":"Coupling Rules with Effects","permalink":"/finder/getting-started/effects"}}');var i=n(4848),r=n(8453),c=n(1556),o=n(4185),d=n(2543);const l={container:"container_GZRm",controls:"controls_Gc2w",list:"list_rXr3"};var a=n(6540);const u=[];const h=c.a.helpers.multiple(function(){return{id:c.a.string.uuid(),subject:["Can't",c.a.hacker.verb(),c.a.hacker.abbreviation(),c.a.hacker.noun()].join(" "),user_name:c.a.person.lastName(),severity:(0,d.random)(0,4)}},{count:5});function m(){const[e,t]=(0,a.useState)([]),[n,s]=(0,a.useState)([]),r=(0,a.useMemo)(()=>({isSelected:t=>e.includes(t),toggle(n){e.includes(n)?t(e.filter(e=>e!==n)):t([...e,n])}}),[e]),c=(0,a.useCallback)(()=>{s([...n,...e]),t([])},[n,e]),d=h.filter(e=>!1===n.includes(e.id));return(0,i.jsxs)("form",{method:"dialog",className:l.container,onSubmit:c,children:[(0,i.jsx)("b",{children:"Welcome to CypressPine systems, Max."}),(0,i.jsx)(o.vR,{items:d,rules:u,context:r,children:(0,i.jsx)("div",{className:l.list,children:(0,i.jsx)(o.vR.Content,{children:{items:x,empty:()=>(0,i.jsxs)(i.Fragment,{children:["No issues found."," ",(0,i.jsx)("button",{type:"button",onClick:()=>s([]),children:"[ Reset ]"})]})}})})}),(0,i.jsxs)("div",{className:l.controls,children:[(0,i.jsx)("button",{type:"submit",disabled:0===e.length,children:"Ignore"}),(0,i.jsx)("button",{type:"submit",disabled:0===e.length,children:"Discard"}),(0,i.jsxs)("button",{type:"submit",disabled:0===e.length,children:[">","/dev/null"]}),(0,i.jsx)("button",{type:"submit",disabled:0===e.length,children:"DM 'lol' & Discard"}),e.length,"/",h.length-n.length," issue(s) selected"]})]})}function x({items:e,context:t}){return e.map(e=>{const n=t.isSelected(e.id);return(0,i.jsxs)("button",{type:"button","data-is-selected":n,onClick:()=>t.toggle(e.id),children:[(0,i.jsx)("input",{type:"checkbox",checked:n,readOnly:!0}),"Severity ",e.severity,": ",e.subject," - ",e.user_name]},e.id)})}const p={},g="Dependent Finder.Content components",j={},f=[{value:"Define the context shape",id:"define-the-context-shape",level:3},{value:"Memoize context reference",id:"memoize-context-reference",level:3},{value:"Consume the context in the Item renderprop",id:"consume-the-context-in-the-item-renderprop",level:3}];function b(e){const t={code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"dependent-findercontent-components",children:"Dependent Finder.Content components"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"User story:"}),"\nMax McHacker needs to select reported issues to forward to the dev team."]}),"\n",(0,i.jsx)(t.p,{children:"We need to track selected issue ids in state, and provide a form to submit the selection."}),"\n",(0,i.jsx)(m,{}),"\n",(0,i.jsx)(t.h3,{id:"define-the-context-shape",children:"Define the context shape"}),"\n",(0,i.jsx)(t.p,{children:"First, we need to inform Finder what our context will look like."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"interface IssueTrackerContext {\n    isSelected: (id: string) => boolean;\n    toggle: (id: string) => void;\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"memoize-context-reference",children:"Memoize context reference"}),"\n",(0,i.jsx)(t.p,{children:"Like any React object prop, you'll want to memoize the context to reduce re-renders."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"function IssueTracker() {\n    const items = useGetIssues();\n    const [selectedItemIds, setSelectedItemIds] = useState<string[]>([]);\n    // highlight-start\n    const context: IssueTrackerContext = useMemo(() => {\n        return {\n            isSelected(id: string) {\n                return selectedItemIds.includes(id);\n            },\n            toggle(id: string) {\n                if (selectedItemIds.includes(id)) {\n                    setSelectedItemIds(selectedItemIds.filter((i) => i !== id));\n                    return;\n                }\n                setSelectedItemIds([...selectedItemIds, id]);\n            },\n        };\n    }, [selectedItems]);\n    // highlight-end\n\n    return (\n        <Finder items={items} rules={rules} context={context}>\n            <Finder.Content>{{ items: IssueTrackerItems }}</Finder.Content>\n        </Finder>\n    );\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"consume-the-context-in-the-item-renderprop",children:"Consume the context in the Item renderprop"}),"\n",(0,i.jsxs)(t.p,{children:["The second generic of the ",(0,i.jsx)(t.code,{children:"FinderContentItemProps"})," type is the Context. From here, you can use those contextual methods and props to your hearts content."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:'function IssueTrackerItems({ items, context }: FinderContentItemProps<Issue, IssueTrackerContext>) {\n    return items.map((item) => {\n        const isSelected = context.isSelected(item.id);\n        return (\n            <button type="button" data-is-selected={isSelected} onClick={() => context.toggle(item.id)} key={item.id}>\n                <input type="checkbox" checked={isSelected} readOnly={true} />\n                Severity {item.severity}: {item.subject} - {item.user_name}\n            </button>\n        );\n    });\n}\n'})})]})}function I(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(b,{...e})}):b(e)}}}]);